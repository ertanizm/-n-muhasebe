<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mutabık - Stok Ekstresi</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="/css/dashboard.css" rel="stylesheet">
    <link href="/css/musteriler.css" rel="stylesheet">
    <link href="/css/stokekstre.css" rel="stylesheet">
    <link href="/css/filtre.css" rel="stylesheet">
</head>
<body>
    <%- include('../sidebar') %>

    <div class="main-content">
        <div class="product-container">
            <div class="page-header">
                <h1 class="page-title">Stok Ekstresi</h1>
                <div class="action-buttons">
                    <div class="export-buttons">
                        <button class="btn btn-outline-success btn-export">
                            <i class="fas fa-file-excel"></i> Excel
                        </button>
                        <button class="btn btn-outline-danger btn-export">
                            <i class="fas fa-file-pdf"></i> PDF
                        </button>
                        <button class="btn btn-outline-primary btn-export">
                            <i class="fas fa-print"></i> Yazdır
                        </button>
                    </div>
                </div>
            </div>

            <!-- Filtreler -->
            <div class="filter-card">
                <div class="filter-header">
                    <h5 class="mb-0"><i class="fas fa-filter me-2"></i>Filtreler</h5>
                    <button class="btn btn-sm btn-outline-secondary" onclick="toggleFilters()">
                        <i class="fas fa-chevron-up" id="filterToggleIcon"></i>
                    </button>
                </div>
                <div class="filter-content" id="filterContent">
                    <div class="row">
                        <div class="col-md-3">
                            <label class="form-label fw-bold">Stok Kodu/Adı</label>
                            <div class="input-group input-group-lg">
                                <span class="input-group-text"><i class="fas fa-search"></i></span>
                                <input type="text" class="form-control " id="stokArama" placeholder="Stok ara...">
                            </div>
                        </div>
                        <div class="col-md-5">
                            <label class="form-label fw-bold">Tarih Aralığı</label>
                            <div class="d-flex align-items-center gap-2">
                                <div class="input-group input-group-lg">
                                    <span class="input-group-text"><i class="fas fa-calendar"></i></span>
                                    <input type="date" class="form-control" id="baslangicTarih" value="2025-01-01">
                                </div>
                                <span class="mx-1">-</span>
                                <div class="input-group input-group-lg">
                                    <input type="date" class="form-control" id="bitisTarih" value="2025-12-31">
                                    <span class="input-group-text"><i class="fas fa-calendar"></i></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label fw-bold">Stok Grubu</label>
                            <div class="input-group input-group-lg">
                                <span class="input-group-text"><i class="fas fa-tags"></i></span>
                                <select class="form-select " id="stokGrubu">
                                    <option value="">Tümü</option>
                                    <option value="elektronik">Elektronik</option>
                                    <option value="giyim">Giyim</option>
                                    <option value="ev">Ev & Yaşam</option>
                                    <option value="spor">Spor</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <label class="form-label fw-bold">Depo</label>
                            <div class="input-group input-group-lg">
                                <span class="input-group-text"><i class="fas fa-warehouse"></i></span>
                                <select class="form-select " id="depoId">
                                    <option value="">Tümü</option>
                                    <option value="1">Ana Depo</option>
                                    <option value="2">Şube Depo</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-md-3">
                            <label class="form-label fw-bold">Başlangıç Bakiyesi</label>
                            <div class="input-group input-group-lg">
                                <span class="input-group-text"><i class="fas fa-boxes"></i></span>
                                <input type="number" class="form-control " id="baslangicBakiye" placeholder="0" value="0" min="0">
                            </div>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label fw-bold">Bitiş Bakiyesi</label>
                            <div class="input-group input-group-lg">
                                <span class="input-group-text"><i class="fas fa-boxes"></i></span>
                                <input type="number" class="form-control " id="bitisBakiye" placeholder="0" value="999999" min="0">
                            </div>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label fw-bold">Sıralama</label>
                            <div class="input-group input-group-lg">
                                <span class="input-group-text"><i class="fas fa-sort"></i></span>
                                <select class="form-select " id="siralama">
                                    <option value="date">Tarih</option>
                                    <option value="stok">Stok Kodu</option>
                                    <option value="quantity">Miktar</option>
                                    <option value="value">Değer</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-3 justify-content-end d-flex align-items-end">
                            <button class="btn btn-primary me-2 btn-lg" onclick="searchStokHareketler()">
                                <i class="fas fa-search"></i> Ara
                            </button>
                            <button class="btn btn-outline-secondary btn-lg" onclick="clearFilters()">
                                <i class="fas fa-times"></i> Temizle
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Özet Kartları -->
            <div class="summary-cards">
                <div class="summary-card">
                    <div class="value positive">+50</div>
                    <div class="label">Toplam Giriş</div>
                </div>
                <div class="summary-card">
                    <div class="value negative">-30</div>
                    <div class="label">Toplam Çıkış</div>
                </div>
                <div class="summary-card">
                    <div class="value">150</div>
                    <div class="label">Mevcut Stok</div>
                </div>
                <div class="summary-card">
                    <div class="value">20</div>
                    <div class="label">Hareket Sayısı</div>
                </div>
                <div class="summary-card">
                    <div class="value">₺15,750</div>
                    <div class="label">Stok Değeri</div>
                </div>
            </div>

            <!-- Stok Hareketleri Tablosu -->
            <div class="movement-table">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>Tarih</th>
                            <th>Hareket Türü</th>
                            <th>Belge No</th>
                            <th>Cari</th>
                            <th>Depo</th>
                            <th>Giriş</th>
                            <th>Çıkış</th>
                            <th>Bakiye</th>
                            <th>Birim Fiyat</th>
                            <th>Toplam Tutar</th>
                            <th>Açıklama</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>01.01.2024</td>
                            <td><span class="movement-type alis">Alış</span></td>
                            <td>ALI-2024-001</td>
                            <td>ABC Ticaret Ltd. Şti.</td>
                            <td>Ana Depo</td>
                            <td class="quantity-positive">+100</td>
                            <td>-</td>
                            <td class="balance-positive">100</td>
                            <td>₺150.00</td>
                            <td>₺15,000.00</td>
                            <td>Yıllık stok alımı</td>
                        </tr>
                        
                    </tbody>
                </table>
            </div>

            <!-- Sayfalama -->
            <div class="pagination-wrapper">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <small class="text-muted">
                            Toplam 20 kayıt gösteriliyor (1-10 / 20)
                        </small>
                    </div>
                    <div class="col-md-6">
                        <nav aria-label="Stok hareketleri sayfalama">
                            <ul class="pagination pagination-sm justify-content-end mb-0">
                                <li class="page-item disabled">
                                    <a class="page-link" href="#" tabindex="-1">Önceki</a>
                                </li>
                                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                <li class="page-item"><a class="page-link" href="#">2</a></li>
                                <li class="page-item">
                                    <a class="page-link" href="#">Sonraki</a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/script.js"></script>
    <script>
        // Stok hareket arama
        function searchStokHareketler() {
            const filters = {
                stok_arama: document.getElementById('stokArama').value,
                stok_grubu: document.getElementById('stokGrubu').value,
                depo_id: document.getElementById('depoId').value,
                baslangic_tarih: document.getElementById('baslangicTarih').value,
                bitis_tarih: document.getElementById('bitisTarih').value,
                baslangic_bakiye: document.getElementById('baslangicBakiye').value,
                bitis_bakiye: document.getElementById('bitisBakiye').value,
                siralama: document.getElementById('siralama').value
            };

            console.log('Stok arama filtresi:', filters);
            alert('Stok arama işlemi başlatıldı');
        }

        // Filtreleri temizle
        function clearFilters() {
            document.getElementById('stokArama').value = '';
            document.getElementById('stokGrubu').value = '';
            document.getElementById('depoId').value = '';
            document.getElementById('baslangicTarih').value = '2025-01-01';
            document.getElementById('bitisTarih').value = '2025-12-31';
            document.getElementById('baslangicBakiye').value = '0';
            document.getElementById('bitisBakiye').value = '999999';
            document.getElementById('siralama').value = 'date';
        }

        // Filtre toggle fonksiyonu
        function toggleFilters() {
            const filterContent = document.getElementById('filterContent');
            const toggleIcon = document.getElementById('filterToggleIcon');
            
            if (filterContent.classList.contains('collapsed')) {
                filterContent.classList.remove('collapsed');
                toggleIcon.classList.remove('fa-chevron-down');
                toggleIcon.classList.add('fa-chevron-up');
            } else {
                filterContent.classList.add('collapsed');
                toggleIcon.classList.remove('fa-chevron-up');
                toggleIcon.classList.add('fa-chevron-down');
            }
        }

        // Filtreleri dışa aktar
        function exportFilters() {
            const filters = {
                stok_arama: document.getElementById('stokArama').value,
                stok_grubu: document.getElementById('stokGrubu').value,
                depo_id: document.getElementById('depoId').value,
                baslangic_tarih: document.getElementById('baslangicTarih').value,
                bitis_tarih: document.getElementById('bitisTarih').value,
                baslangic_bakiye: document.getElementById('baslangicBakiye').value,
                bitis_bakiye: document.getElementById('bitisBakiye').value,
                siralama: document.getElementById('siralama').value
            };
            
            const filterText = Object.entries(filters)
                .filter(([key, value]) => value)
                .map(([key, value]) => `${key}: ${value}`)
                .join('\n');
            
            const blob = new Blob([filterText], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'stok_filtreleri.txt';
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Export butonları
        document.querySelectorAll('.btn-export').forEach(btn => {
            btn.addEventListener('click', function() {
                const action = this.textContent.trim();
                console.log('Export işlemi:', action);
                alert(`${action} işlemi başlatıldı`);
            });
        });

        // Enter tuşu ile arama
        document.querySelectorAll('#stokArama, #baslangicBakiye, #bitisBakiye').forEach(input => {
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchStokHareketler();
                }
            });
        });

        // Tablo satır tıklama
        document.querySelectorAll('.table tbody tr').forEach(row => {
            row.addEventListener('click', function() {
                // Satır detaylarını göster
                console.log('Satır tıklandı:', this);
            });
        });
    </script>
</body>
</html> 